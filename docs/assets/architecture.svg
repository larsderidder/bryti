<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 780 400" font-family="system-ui, -apple-system, sans-serif" font-size="13">
  <defs>
    <marker id="arrow" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#666"/>
    </marker>
    <marker id="arrow-blue" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#4a90d9"/>
    </marker>
    <marker id="arrow-red" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#ef4444"/>
    </marker>
    <marker id="arrow-green" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#10b981"/>
    </marker>
  </defs>

  <style>
    .box { rx: 6; ry: 6; stroke-width: 1.5; }
    .label { font-weight: 600; font-size: 13px; }
    .sublabel { font-size: 11px; fill: #666; }
    .section-label { font-size: 10px; font-weight: 600; fill: #999; letter-spacing: 0.5px; text-transform: uppercase; }
  </style>

  <!-- Channels -->
  <rect x="16" y="120" width="110" height="44" class="box" fill="#f0f4f8" stroke="#b0bec5"/>
  <text x="71" y="140" text-anchor="middle" class="label" fill="#37474f">Telegram</text>
  <text x="71" y="154" text-anchor="middle" class="sublabel">grammy</text>

  <rect x="16" y="180" width="110" height="44" class="box" fill="#f0f4f8" stroke="#b0bec5"/>
  <text x="71" y="200" text-anchor="middle" class="label" fill="#37474f">WhatsApp</text>
  <text x="71" y="214" text-anchor="middle" class="sublabel">baileys</text>

  <text x="71" y="108" text-anchor="middle" class="section-label">Channels</text>

  <!-- Arrows: channels → agent -->
  <line x1="126" y1="142" x2="178" y2="168" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="126" y1="202" x2="178" y2="188" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Agent core -->
  <rect x="182" y="130" width="190" height="100" class="box" fill="#e8f0fe" stroke="#4a90d9"/>
  <text x="277" y="158" text-anchor="middle" class="label" fill="#1a56db">Agent</text>
  <text x="277" y="176" text-anchor="middle" class="sublabel">pi SDK session</text>
  <text x="277" y="192" text-anchor="middle" class="sublabel">model fallback chain</text>
  <text x="277" y="208" text-anchor="middle" class="sublabel">trust + guardrail</text>

  <!-- Projections -->
  <rect x="182" y="20" width="190" height="70" class="box" fill="#fef3c7" stroke="#d97706"/>
  <text x="277" y="46" text-anchor="middle" class="label" fill="#92400e">Projections</text>
  <text x="277" y="62" text-anchor="middle" class="sublabel">time, event, recurring, deps</text>
  <text x="277" y="76" text-anchor="middle" class="sublabel">reflection pass every 30 min</text>

  <text x="277" y="12" text-anchor="middle" class="section-label">Forward-looking</text>

  <!-- Arrow: agent ↔ projections -->
  <line x1="277" y1="130" x2="277" y2="94" stroke="#d97706" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Memory stack -->
  <rect x="182" y="278" width="190" height="90" class="box" fill="#f3e8ff" stroke="#8b5cf6"/>
  <text x="277" y="302" text-anchor="middle" class="label" fill="#6d28d9">Memory</text>
  <text x="277" y="320" text-anchor="middle" class="sublabel">core (always in context)</text>
  <text x="277" y="336" text-anchor="middle" class="sublabel">archival (hybrid search)</text>
  <text x="277" y="352" text-anchor="middle" class="sublabel">conversation logs</text>

  <text x="277" y="268" text-anchor="middle" class="section-label">Always in context</text>

  <!-- Arrow: agent ↔ memory -->
  <line x1="277" y1="230" x2="277" y2="274" stroke="#8b5cf6" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Security boundary -->
  <rect x="430" y="55" width="330" height="210" rx="8" ry="8" fill="#fef2f2" fill-opacity="0.3" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="595" y="75" text-anchor="middle" class="section-label" fill="#dc2626">Isolated — no access to agent context</text>

  <!-- Workers -->
  <rect x="458" y="90" width="125" height="70" class="box" fill="#fff" stroke="#ef4444"/>
  <text x="520" y="115" text-anchor="middle" class="label" fill="#991b1b">Worker</text>
  <text x="520" y="131" text-anchor="middle" class="sublabel">web search</text>
  <text x="520" y="145" text-anchor="middle" class="sublabel">URL fetch</text>

  <rect x="610" y="90" width="125" height="70" class="box" fill="#fff" stroke="#ef4444"/>
  <text x="672" y="115" text-anchor="middle" class="label" fill="#991b1b">Worker</text>
  <text x="672" y="131" text-anchor="middle" class="sublabel">web search</text>
  <text x="672" y="145" text-anchor="middle" class="sublabel">URL fetch</text>

  <!-- Result file -->
  <rect x="530" y="195" width="130" height="45" class="box" fill="#fff" stroke="#d1d5db"/>
  <text x="595" y="215" text-anchor="middle" class="label" fill="#374151">result.md</text>
  <text x="595" y="230" text-anchor="middle" class="sublabel">cleaned output</text>

  <!-- Arrow: agent → workers -->
  <line x1="372" y1="160" x2="454" y2="125" stroke="#ef4444" stroke-width="1.2" marker-end="url(#arrow-red)"/>
  <text x="408" y="132" text-anchor="middle" class="sublabel" fill="#ef4444">dispatch</text>

  <!-- Arrows: workers → result -->
  <line x1="520" y1="160" x2="560" y2="191" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/>
  <line x1="672" y1="160" x2="635" y2="191" stroke="#666" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Arrow: result → agent (reads) -->
  <line x1="530" y1="225" x2="376" y2="200" stroke="#4a90d9" stroke-width="1.2" marker-end="url(#arrow-blue)"/>
  <text x="460" y="222" text-anchor="middle" class="sublabel" fill="#4a90d9">file_read</text>

  <!-- Extensions (outside boundary) -->
  <rect x="458" y="310" width="160" height="50" class="box" fill="#ecfdf5" stroke="#10b981"/>
  <text x="538" y="332" text-anchor="middle" class="label" fill="#065f46">Extensions</text>
  <text x="538" y="347" text-anchor="middle" class="sublabel">agent-written TypeScript tools</text>

  <!-- Arrow: agent → extensions -->
  <line x1="372" y1="215" x2="454" y2="325" stroke="#10b981" stroke-width="1.2" marker-end="url(#arrow-green)"/>

</svg>
