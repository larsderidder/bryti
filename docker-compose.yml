services:
  pibot:
    build:
      context: .
      dockerfile: Dockerfile
    restart: unless-stopped
    volumes:
      - ./data:/data
    env_file: .env
    environment:
      - PIBOT_DATA_DIR=/data

  # ---------------------------------------------------------------------------
  # HedgeDoc â€” collaborative document editing (optional)
  #
  # Provides document_create, document_update, document_read tools via the
  # documents-hedgedoc extension in data/files/extensions/.
  #
  # To activate:
  #   1. Uncomment this block and hedgedoc_db below
  #   2. Set HEDGEDOC_URL and HEDGEDOC_PUBLIC_URL in your .env file
  #   3. The extension picks them up automatically on next start
  #
  # .env entries needed:
  #   HEDGEDOC_URL=http://hedgedoc:3000
  #   HEDGEDOC_PUBLIC_URL=https://docs.yourdomain.com
  #   HEDGEDOC_DOMAIN=docs.yourdomain.com
  #   HEDGEDOC_SECRET=<run: openssl rand -hex 32>
  # ---------------------------------------------------------------------------
  # hedgedoc:
  #   image: quay.io/hedgedoc/hedgedoc:1.10
  #   restart: unless-stopped
  #   environment:
  #     - CMD_DB_URL=postgres://hedgedoc:hedgedoc@hedgedoc_db:5432/hedgedoc
  #     - CMD_DOMAIN=${HEDGEDOC_DOMAIN}          # public hostname, no protocol
  #     - CMD_URL_ADDPORT=false
  #     - CMD_PROTOCOL_USESSL=true
  #     - CMD_ALLOW_ANONYMOUS=true               # allow anonymous note creation
  #     - CMD_ALLOW_FREEURL=true                 # required for document_update to work
  #     - CMD_SESSION_SECRET=${HEDGEDOC_SECRET}
  #   volumes:
  #     - hedgedoc_uploads:/hedgedoc/public/uploads
  #   depends_on:
  #     - hedgedoc_db
  #
  # hedgedoc_db:
  #   image: postgres:16-alpine
  #   restart: unless-stopped
  #   environment:
  #     - POSTGRES_USER=hedgedoc
  #     - POSTGRES_PASSWORD=hedgedoc
  #     - POSTGRES_DB=hedgedoc
  #   volumes:
  #     - hedgedoc_db_data:/var/lib/postgresql/data

  # Uncomment for production with webhook mode
  # caddy:
  #   image: caddy:2-alpine
  #   restart: unless-stopped
  #   ports:
  #     - "80:80"
  #     - "443:443"
  #   volumes:
  #     - ./Caddyfile:/etc/caddy/Caddyfile
  #     - caddy_data:/data
  #     - caddy_config:/config

# volumes:
#   caddy_data:
#   caddy_config:
#   hedgedoc_uploads:
#   hedgedoc_db_data:
